# Dracut configuration for MiniOS
# Based on UIRD approach - no systemd in initramfs

# Build for all hardware, not just current
hostonly="no"

# Disable early microcode
early_microcode="no"

# Compression
compress="zstd"

# DO NOT load systemd modules - use traditional dracut init
# MiniOS uses its own init system based on livekitlib
omit_dracutmodules+=" systemd systemd-initrd dracut-systemd "
omit_dracutmodules+=" systemd-ask-password systemd-journald "
omit_dracutmodules+=" systemd-modules-load systemd-sysctl "
omit_dracutmodules+=" systemd-tmpfiles systemd-udevd "
omit_dracutmodules+=" systemd-sysusers systemd-battery-check "
omit_dracutmodules+=" systemd-pcrphase "

# Omit unnecessary modules to reduce size
omit_dracutmodules+=" plymouth dash resume usrmount "
omit_dracutmodules+=" btrfs mdraid dmraid lvm crypt "
omit_dracutmodules+=" nvdimm qemu qemu-net virtiofs "
omit_dracutmodules+=" nfs cifs iscsi fcoe fcoe-uefi "
omit_dracutmodules+=" multipath biosdevname "
omit_dracutmodules+=" console-setup i18n "
omit_dracutmodules+=" overlay-root dmsquash-live "
omit_dracutmodules+=" network network-manager network-legacy dbus dbus-daemon "

# Omit video drivers
omit_drivers+=" nouveau vboxvideo "
